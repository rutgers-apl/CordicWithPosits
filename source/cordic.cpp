#include "cordic.h"

posit32 k_p32[14] = {
    0.7071067802608013153076171875,
    0.6324555315077304840087890625,
    0.6135719902813434600830078125,
    0.6088339127600193023681640625,
    0.6076482571661472320556640625,
    0.6073517687618732452392578125,
    0.6072776429355144500732421875,
    0.6072591133415699005126953125,
    0.6072544790804386138916015625,
    0.607253320515155792236328125,
    0.60725302994251251220703125,
    0.6072529591619968414306640625,
    0.60725294053554534912109375,
    0.6072529368102550506591796875
};

posit32 KVals[15] = {
    0.6072529368102550506591796875,
    0.8587853349745273590087890625,
    0.960151195526123046875,
    0.9897012002766132354736328125,
    0.9974032677710056304931640625,
    0.999349422752857208251953125,
    0.9998372681438922882080078125,
    0.999959312379360198974609375,
    0.9999898262321949005126953125,
    0.9999974556267261505126953125,
    0.9999993629753589630126953125,
    0.9999998398125171661376953125,
    0.9999999590218067169189453125,
    0.9999999888241291046142578125,
    0.9999999962747097015380859375
};

posit32 atan_table_p32[200] = {
    7.8539816290140151977539062500000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.2729521915316581726074218750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.7991465404629707336425781250000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9483995512127876281738281250000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9870096147060394287109375000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9967467039823532104492187500000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9991863220930099487304687500000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9997965618968009948730468750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9999491497874259948730468750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9999872967600822448730468750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9999968335032463073730468750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9999992176890373229980468750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9999998137354850769042968750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    9.9999999627470970153808593750000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    5.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    2.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    5.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    2.5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    2.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    5.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    2.5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    1.2500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    6.2500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-02,
    3.1250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-02,
    1.5625000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-02,
    7.8125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-03,
    3.9062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-03,
    1.9531250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-03,
    9.7656250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    4.8828125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    2.4414062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    1.2207031250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    6.1035156250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-05,
    3.0517578125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-05,
    1.5258789062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-05,
    7.6293945312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-06,
    3.8146972656250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-06,
    1.9073486328125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-06,
    9.5367431640625000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    4.7683715820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    2.3841857910156250000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    1.1920928955078125000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    5.9604644775390625000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-08,
    2.9802322387695312500000000000000000000000000000000000000000000000000000000000000000000000000000000000e-08,
    1.4901161193847656250000000000000000000000000000000000000000000000000000000000000000000000000000000000e-08,
    7.4505805969238281250000000000000000000000000000000000000000000000000000000000000000000000000000000000e-09,
    3.7252902984619140625000000000000000000000000000000000000000000000000000000000000000000000000000000000e-09,
    1.8626451492309570312500000000000000000000000000000000000000000000000000000000000000000000000000000000e-09,
    9.3132257461547851562500000000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    4.6566128730773925781250000000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    2.3283064365386962890625000000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    1.1641532182693481445312500000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    5.8207660913467407226562500000000000000000000000000000000000000000000000000000000000000000000000000000e-11,
    2.9103830456733703613281250000000000000000000000000000000000000000000000000000000000000000000000000000e-11,
    1.4551915228366851806640625000000000000000000000000000000000000000000000000000000000000000000000000000e-11,
    7.2759576141834259033203125000000000000000000000000000000000000000000000000000000000000000000000000000e-12,
    3.6379788070917129516601562500000000000000000000000000000000000000000000000000000000000000000000000000e-12,
    1.8189894035458564758300781250000000000000000000000000000000000000000000000000000000000000000000000000e-12,
    9.0949470177292823791503906250000000000000000000000000000000000000000000000000000000000000000000000000e-13,
    4.5474735088646411895751953125000000000000000000000000000000000000000000000000000000000000000000000000e-13,
    2.2737367544323205947875976562500000000000000000000000000000000000000000000000000000000000000000000000e-13,
    1.1368683772161602973937988281250000000000000000000000000000000000000000000000000000000000000000000000e-13,
    5.6843418860808014869689941406250000000000000000000000000000000000000000000000000000000000000000000000e-14,
    2.8421709430404007434844970703125000000000000000000000000000000000000000000000000000000000000000000000e-14,
    1.4210854715202003717422485351562500000000000000000000000000000000000000000000000000000000000000000000e-14,
    7.1054273576010018587112426757812500000000000000000000000000000000000000000000000000000000000000000000e-15,
    3.5527136788005009293556213378906250000000000000000000000000000000000000000000000000000000000000000000e-15,
    1.7763568394002504646778106689453125000000000000000000000000000000000000000000000000000000000000000000e-15,
    8.8817841970012523233890533447265625000000000000000000000000000000000000000000000000000000000000000000e-16,
    4.4408920985006261616945266723632812500000000000000000000000000000000000000000000000000000000000000000e-16,
    2.2204460492503130808472633361816406250000000000000000000000000000000000000000000000000000000000000000e-16,
    1.1102230246251565404236316680908203125000000000000000000000000000000000000000000000000000000000000000e-16,
    5.5511151231257827021181583404541015625000000000000000000000000000000000000000000000000000000000000000e-17,
    2.7755575615628913510590791702270507812500000000000000000000000000000000000000000000000000000000000000e-17,
    1.3877787807814456755295395851135253906250000000000000000000000000000000000000000000000000000000000000e-17,
    6.9388939039072283776476979255676269531250000000000000000000000000000000000000000000000000000000000000e-18,
    3.4694469519536141888238489627838134765625000000000000000000000000000000000000000000000000000000000000e-18,
    1.7347234759768070944119244813919067382812500000000000000000000000000000000000000000000000000000000000e-18,
    8.6736173798840354720596224069595336914062500000000000000000000000000000000000000000000000000000000000e-19,
    4.3368086899420177360298112034797668457031250000000000000000000000000000000000000000000000000000000000e-19,
    2.1684043449710088680149056017398834228515625000000000000000000000000000000000000000000000000000000000e-19,
    1.0842021724855044340074528008699417114257812500000000000000000000000000000000000000000000000000000000e-19,
    5.4210108624275221700372640043497085571289062500000000000000000000000000000000000000000000000000000000e-20,
    2.7105054312137610850186320021748542785644531250000000000000000000000000000000000000000000000000000000e-20,
    1.3552527156068805425093160010874271392822265625000000000000000000000000000000000000000000000000000000e-20,
    6.7762635780344027125465800054371356964111328125000000000000000000000000000000000000000000000000000000e-21,
    3.3881317890172013562732900027185678482055664062500000000000000000000000000000000000000000000000000000e-21,
    1.6940658945086006781366450013592839241027832031250000000000000000000000000000000000000000000000000000e-21,
    8.4703294725430033906832250067964196205139160156250000000000000000000000000000000000000000000000000000e-22,
    4.2351647362715016953416125033982098102569580078125000000000000000000000000000000000000000000000000000e-22,
    2.1175823681357508476708062516991049051284790039062500000000000000000000000000000000000000000000000000e-22,
    1.0587911840678754238354031258495524525642395019531250000000000000000000000000000000000000000000000000e-22,
    5.2939559203393771191770156292477622628211975097656250000000000000000000000000000000000000000000000000e-23,
    2.6469779601696885595885078146238811314105987548828125000000000000000000000000000000000000000000000000e-23,
    1.3234889800848442797942539073119405657052993774414062500000000000000000000000000000000000000000000000e-23,
    6.6174449004242213989712695365597028285264968872070312500000000000000000000000000000000000000000000000e-24,
    3.3087224502121106994856347682798514142632484436035156250000000000000000000000000000000000000000000000e-24,
    1.6543612251060553497428173841399257071316242218017578125000000000000000000000000000000000000000000000e-24
};

posit32 scale_table_p32[200] = {
    1.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e+00,
    5.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    2.5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    1.2500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-01,
    6.2500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-02,
    3.1250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-02,
    1.5625000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-02,
    7.8125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-03,
    3.9062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-03,
    1.9531250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-03,
    9.7656250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    4.8828125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    2.4414062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    1.2207031250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-04,
    6.1035156250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-05,
    3.0517578125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-05,
    1.5258789062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-05,
    7.6293945312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-06,
    3.8146972656250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-06,
    1.9073486328125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-06,
    9.5367431640625000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    4.7683715820312500000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    2.3841857910156250000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    1.1920928955078125000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-07,
    5.9604644775390625000000000000000000000000000000000000000000000000000000000000000000000000000000000000e-08,
    2.9802322387695312500000000000000000000000000000000000000000000000000000000000000000000000000000000000e-08,
    1.4901161193847656250000000000000000000000000000000000000000000000000000000000000000000000000000000000e-08,
    7.4505805969238281250000000000000000000000000000000000000000000000000000000000000000000000000000000000e-09,
    3.7252902984619140625000000000000000000000000000000000000000000000000000000000000000000000000000000000e-09,
    1.8626451492309570312500000000000000000000000000000000000000000000000000000000000000000000000000000000e-09,
    9.3132257461547851562500000000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    4.6566128730773925781250000000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    2.3283064365386962890625000000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    1.1641532182693481445312500000000000000000000000000000000000000000000000000000000000000000000000000000e-10,
    5.8207660913467407226562500000000000000000000000000000000000000000000000000000000000000000000000000000e-11,
    2.9103830456733703613281250000000000000000000000000000000000000000000000000000000000000000000000000000e-11,
    1.4551915228366851806640625000000000000000000000000000000000000000000000000000000000000000000000000000e-11,
    7.2759576141834259033203125000000000000000000000000000000000000000000000000000000000000000000000000000e-12,
    3.6379788070917129516601562500000000000000000000000000000000000000000000000000000000000000000000000000e-12,
    1.8189894035458564758300781250000000000000000000000000000000000000000000000000000000000000000000000000e-12,
    9.0949470177292823791503906250000000000000000000000000000000000000000000000000000000000000000000000000e-13,
    4.5474735088646411895751953125000000000000000000000000000000000000000000000000000000000000000000000000e-13,
    2.2737367544323205947875976562500000000000000000000000000000000000000000000000000000000000000000000000e-13,
    1.1368683772161602973937988281250000000000000000000000000000000000000000000000000000000000000000000000e-13,
    5.6843418860808014869689941406250000000000000000000000000000000000000000000000000000000000000000000000e-14,
    2.8421709430404007434844970703125000000000000000000000000000000000000000000000000000000000000000000000e-14,
    1.4210854715202003717422485351562500000000000000000000000000000000000000000000000000000000000000000000e-14,
    7.1054273576010018587112426757812500000000000000000000000000000000000000000000000000000000000000000000e-15,
    3.5527136788005009293556213378906250000000000000000000000000000000000000000000000000000000000000000000e-15,
    1.7763568394002504646778106689453125000000000000000000000000000000000000000000000000000000000000000000e-15,
    8.8817841970012523233890533447265625000000000000000000000000000000000000000000000000000000000000000000e-16,
    4.4408920985006261616945266723632812500000000000000000000000000000000000000000000000000000000000000000e-16,
    2.2204460492503130808472633361816406250000000000000000000000000000000000000000000000000000000000000000e-16,
    1.1102230246251565404236316680908203125000000000000000000000000000000000000000000000000000000000000000e-16,
    5.5511151231257827021181583404541015625000000000000000000000000000000000000000000000000000000000000000e-17,
    2.7755575615628913510590791702270507812500000000000000000000000000000000000000000000000000000000000000e-17,
    1.3877787807814456755295395851135253906250000000000000000000000000000000000000000000000000000000000000e-17,
    6.9388939039072283776476979255676269531250000000000000000000000000000000000000000000000000000000000000e-18,
    3.4694469519536141888238489627838134765625000000000000000000000000000000000000000000000000000000000000e-18,
    1.7347234759768070944119244813919067382812500000000000000000000000000000000000000000000000000000000000e-18,
    8.6736173798840354720596224069595336914062500000000000000000000000000000000000000000000000000000000000e-19,
    4.3368086899420177360298112034797668457031250000000000000000000000000000000000000000000000000000000000e-19,
    2.1684043449710088680149056017398834228515625000000000000000000000000000000000000000000000000000000000e-19,
    1.0842021724855044340074528008699417114257812500000000000000000000000000000000000000000000000000000000e-19,
    5.4210108624275221700372640043497085571289062500000000000000000000000000000000000000000000000000000000e-20,
    2.7105054312137610850186320021748542785644531250000000000000000000000000000000000000000000000000000000e-20,
    1.3552527156068805425093160010874271392822265625000000000000000000000000000000000000000000000000000000e-20,
    6.7762635780344027125465800054371356964111328125000000000000000000000000000000000000000000000000000000e-21,
    3.3881317890172013562732900027185678482055664062500000000000000000000000000000000000000000000000000000e-21,
    1.6940658945086006781366450013592839241027832031250000000000000000000000000000000000000000000000000000e-21,
    8.4703294725430033906832250067964196205139160156250000000000000000000000000000000000000000000000000000e-22,
    4.2351647362715016953416125033982098102569580078125000000000000000000000000000000000000000000000000000e-22,
    2.1175823681357508476708062516991049051284790039062500000000000000000000000000000000000000000000000000e-22,
    1.0587911840678754238354031258495524525642395019531250000000000000000000000000000000000000000000000000e-22,
    5.2939559203393771191770156292477622628211975097656250000000000000000000000000000000000000000000000000e-23,
    2.6469779601696885595885078146238811314105987548828125000000000000000000000000000000000000000000000000e-23,
    1.3234889800848442797942539073119405657052993774414062500000000000000000000000000000000000000000000000e-23,
    6.6174449004242213989712695365597028285264968872070312500000000000000000000000000000000000000000000000e-24,
    3.3087224502121106994856347682798514142632484436035156250000000000000000000000000000000000000000000000e-24,
    1.6543612251060553497428173841399257071316242218017578125000000000000000000000000000000000000000000000e-24,
    8.2718061255302767487140869206996285356581211090087890625000000000000000000000000000000000000000000000e-25,
    4.1359030627651383743570434603498142678290605545043945312500000000000000000000000000000000000000000000e-25,
    2.0679515313825691871785217301749071339145302772521972656250000000000000000000000000000000000000000000e-25,
    1.0339757656912845935892608650874535669572651386260986328125000000000000000000000000000000000000000000e-25,
    5.1698788284564229679463043254372678347863256931304931640625000000000000000000000000000000000000000000e-26,
    2.5849394142282114839731521627186339173931628465652465820312500000000000000000000000000000000000000000e-26,
    1.2924697071141057419865760813593169586965814232826232910156250000000000000000000000000000000000000000e-26,
    6.4623485355705287099328804067965847934829071164131164550781250000000000000000000000000000000000000000e-27,
    3.2311742677852643549664402033982923967414535582065582275390625000000000000000000000000000000000000000e-27,
    1.6155871338926321774832201016991461983707267791032791137695312500000000000000000000000000000000000000e-27,
    8.0779356694631608874161005084957309918536338955163955688476562500000000000000000000000000000000000000e-28,
    4.0389678347315804437080502542478654959268169477581977844238281250000000000000000000000000000000000000e-28,
    2.0194839173657902218540251271239327479634084738790988922119140625000000000000000000000000000000000000e-28,
    1.0097419586828951109270125635619663739817042369395494461059570312500000000000000000000000000000000000e-28,
    5.0487097934144755546350628178098318699085211846977472305297851562500000000000000000000000000000000000e-29,
    2.5243548967072377773175314089049159349542605923488736152648925781250000000000000000000000000000000000e-29,
    1.2621774483536188886587657044524579674771302961744368076324462890625000000000000000000000000000000000e-29,
    6.3108872417680944432938285222622898373856514808721840381622314453125000000000000000000000000000000000e-30,
    3.1554436208840472216469142611311449186928257404360920190811157226562500000000000000000000000000000000e-30,
    1.5777218104420236108234571305655724593464128702180460095405578613281250000000000000000000000000000000e-30,
    7.8886090522101180541172856528278622967320643510902300477027893066406250000000000000000000000000000000e-31,
    3.9443045261050590270586428264139311483660321755451150238513946533203125000000000000000000000000000000e-31,
    1.9721522630525295135293214132069655741830160877725575119256973266601562500000000000000000000000000000e-31,
    9.8607613152626475676466070660348278709150804388627875596284866333007812500000000000000000000000000000e-32,
    4.9303806576313237838233035330174139354575402194313937798142433166503906250000000000000000000000000000e-32,
    2.4651903288156618919116517665087069677287701097156968899071216583251953125000000000000000000000000000e-32,
    1.2325951644078309459558258832543534838643850548578484449535608291625976562500000000000000000000000000e-32,
    6.1629758220391547297791294162717674193219252742892422247678041458129882812500000000000000000000000000e-33,
    3.0814879110195773648895647081358837096609626371446211123839020729064941406250000000000000000000000000e-33,
    1.5407439555097886824447823540679418548304813185723105561919510364532470703125000000000000000000000000e-33,
    7.7037197775489434122239117703397092741524065928615527809597551822662353515625000000000000000000000000e-34,
    3.8518598887744717061119558851698546370762032964307763904798775911331176757812500000000000000000000000e-34,
    1.9259299443872358530559779425849273185381016482153881952399387955665588378906250000000000000000000000e-34,
    1.9259299443872358530559779425849273185381016482153881952399387955665588378906250000000000000000000000e-34,
    4.8148248609680896326399448564623182963452541205384704880998469889163970947265625000000000000000000000e-35,
    1.2037062152420224081599862141155795740863135301346176220249617472290992736816406250000000000000000000e-35,
    1.2037062152420224081599862141155795740863135301346176220249617472290992736816406250000000000000000000e-35,
    1.2037062152420224081599862141155795740863135301346176220249617472290992736816406250000000000000000000e-35,
    1.2037062152420224081599862141155795740863135301346176220249617472290992736816406250000000000000000000e-35,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37,
    7.5231638452626400509999138382223723380394595633413601376560109201818704605102539062500000000000000000e-37
};

float atan_table[60] = {
    7.8539816339744830962E-01f,
    4.6364760900080611621E-01f,
    2.4497866312686415417E-01f,
    1.2435499454676143503E-01f,
    6.2418809995957348474E-02f,
    3.1239833430268276254E-02f,
    1.5623728620476830803E-02f,
    7.8123410601011112965E-03f,
    3.9062301319669718276E-03f,
    1.9531225164788186851E-03f,
    9.7656218955931943040E-04f,
    4.8828121119489827547E-04f,
    2.4414062014936176402E-04f,
    1.2207031189367020424E-04f,
    6.1035156174208775022E-05f,
    3.0517578115526096862E-05f,
    1.5258789061315762107E-05f,
    7.6293945311019702634E-06f,
    3.8146972656064962829E-06f,
    1.9073486328101870354E-06f,
    9.5367431640596087942E-07f,
    4.7683715820308885993E-07f,
    2.3841857910155798249E-07f,
    1.1920928955078068531E-07f,
    5.9604644775390554414E-08f,
    2.9802322387695303677E-08f,
    1.4901161193847655147E-08f,
    7.4505805969238279871E-09f,
    3.7252902984619140453E-09f,
    1.8626451492309570291E-09f,
    9.3132257461547851536E-10f,
    4.6566128730773925778E-10f,
    2.3283064365386962890E-10f,
    1.1641532182693481445E-10f,
    5.8207660913467407226E-11f,
    2.9103830456733703613E-11f,
    1.4551915228366851807E-11f,
    7.2759576141834259033E-12f,
    3.6379788070917129517E-12f,
    1.8189894035458564758E-12f,
    9.0949470177292823792E-13f,
    4.5474735088646411896E-13f,
    2.2737367544323205948E-13f,
    1.1368683772161602974E-13f,
    5.6843418860808014870E-14f,
    2.8421709430404007435E-14f,
    1.4210854715202003717E-14f,
    7.1054273576010018587E-15f,
    3.5527136788005009294E-15f,
    1.7763568394002504647E-15f,
    8.8817841970012523234E-16f,
    4.4408920985006261617E-16f,
    2.2204460492503130808E-16f,
    1.1102230246251565404E-16f,
    5.5511151231257827021E-17f,
    2.7755575615628913511E-17f,
    1.3877787807814456755E-17f,
    6.9388939039072283776E-18f,
    3.4694469519536141888E-18f,
    1.7347234759768070944E-18f };

float k[33] = {
    0.70710678118654752440f,
    0.63245553203367586640f,
    0.61357199107789634961f,
    0.60883391251775242102f,
    0.60764825625616820093f,
    0.60735177014129595905f,
    0.60727764409352599905f,
    0.60725911229889273006f,
    0.60725447933256232972f,
    0.60725332108987516334f,
    0.60725303152913433540f,
    0.60725295913894481363f,
    0.60725294104139716351f,
    0.60725293651701023413f,
    0.60725293538591350073f,
    0.60725293510313931731f,
    0.60725293503244577146f,
    0.60725293501477238499f,
    0.60725293501035403837f,
    0.60725293500924945172f,
    0.60725293500897330506f,
    0.60725293500890426839f,
    0.60725293500888700922f,
    0.60725293500888269443f,
    0.60725293500888161574f,
    0.60725293500888134606f,
    0.60725293500888127864f,
    0.60725293500888126179f,
    0.60725293500888125757f,
    0.60725293500888125652f,
    0.60725293500888125626f,
    0.60725293500888125619f,
    0.60725293500888125617f };

/*####################################################################
   Floating point implementation of the CORDIC algorithm.
  ####################################################################*/

void float_cordic(float z, int n, float& xr, float& yr) {
    float x = (n - 1) > 32 ? k[32] : k[n - 1];
    float y = 0.0;
    float di;
    float pow2 = 1.0;
    
    for (int i = 0; i < n; i++) {
        if (z >= 0) di = 1;
        else di = -1;
        float rot_ang = atan_table[i];
        
        float x_prime = x - y * di * pow2;
        float y_prime = y + x * di * pow2;
        
        x = x_prime;
        y = y_prime;
        z = z - di * rot_ang;
        pow2 /= 2.0;
    }
    
    xr = x;
    yr = y;
    return;
}

// This is the default posit algorithm for calculating atan.
float float_vector(float x, float y, int n) {
    float di, z = 0.0, pow2 = 1.0;
    
    for (int i = 0; i < n; i++) {
        if (y >= 0) di = 1.0;
        else di = -1.0;
        float rot_ang = atan_table[i];

        float x_prime = x + y * di * pow2;
        float y_prime = y - x * di * pow2;
        
        x = x_prime;
        y = y_prime;
        z = z + di * rot_ang;
        pow2 /= 2.0;
    }

    return z;
}

// Assume that ps is bitpattern for x \in (0, pi/2].
int GetExponentValueForAngles0ToPiOver2(unsigned int ps) {
    // You can only start at 120^th iteration at best.
    if (ps == 0) return -124;
    if (ps >> 30) return 0;

    int lz = __builtin_clz(ps);
    unsigned int exp = (lz >= 31) ? 0 : ps << (lz + 1);
    exp >>= 30;
    return (lz - 1) * -4 + exp;
}

// Assuming ps can be any positive value in <32, 2>, extract the exponent value.
int GetExponentValueForPosReals(unsigned int ps) {
    // This if statement is not true, but you can only start at 120^th iteration at best.
    unsigned int regimeSign = ps >> 30;
    unsigned int temp = regimeSign ? ~(ps << 1) : (ps << 1);

    int lz = __builtin_clz(temp);
    unsigned int exp = (lz >= 30) ? 0 : (ps << (lz+2));
    exp >>= 30;
    
    if (regimeSign) return (lz - 1) * 4 + exp;
    else return -4 * lz + exp;
}

// This is the default posit algorithm for calculating sin and cos for x \in [0, pi/2].
void posit_cordic_default(posit32 z, int n, posit32& xr, posit32& yr) {
    posit32 x = (n - 1) > 13 ? k_p32[13] : k_p32[n - 1];
    posit32 y = 0.0;
    posit32 di;
    
    for (int i = 0; i < n; i++) {
        if (z >= 0) di = 1;
        else di = -1;
        posit32 pow2 = scale_table_p32[i];
        posit32 rot_ang = atan_table_p32[i] * pow2;
        
        posit32 x_prime = x - y * di * pow2;
        posit32 y_prime = y + x * di * pow2;
        
        x = x_prime;
        y = y_prime;
        z = z - di * rot_ang;
    }
    
    xr = x;
    yr = y;
}

// What happens if we use quire for z?
void posit_cordic_quirez(posit32 z, int n, posit32& xr, posit32& yr) {
    posit32 x = (n - 1) > 13 ? k_p32[13] : k_p32[n - 1];
    posit32 y = 0.0;
    posit32 di;
    
    quire32 qz;
    qz.qma(z, 1.0);
    
    //iterate cordic algorithm
    for (int i = 0; i < n; i++) {
        posit32 rot_ang = atan_table_p32[i];
        posit32 pow2 = scale_table_p32[i];
        
        if(qz.toPosit() >= 0) di = 1;
        else di = -1;
        
        posit32 xprime = x - y * di * pow2;
        posit32 yprime = y + x * di * pow2;
        
        x = xprime;
        y = yprime;
        qz.qms(rot_ang, pow2 * di);
    }
    
    xr = x;
    yr = y;
}

void posit_cordic_ff(posit32 z, int n, posit32& xr, posit32& yr) {
    if (n < 17) {
        printf("We require n >= 17.\n");
        exit(0);
    }

    posit32 di, y = 0.0;

	int i = -GetExponentValueForAngles0ToPiOver2(z.value);
	if (i > 0) i -= 1;
    posit32 x = (i >= 15) ? 1 : KVals[i];
    int c = i + n;
    if (c > 121) c = 121;
    
    for (; i < c; i++) {
        if (z >= 0) di = 1;
        else di = -1;
        posit32 pow2 = scale_table_p32[i];
        posit32 rot_ang = atan_table_p32[i] * pow2;

        posit32 xprime = x - y * di * pow2;
        posit32 yprime = y + x * di * pow2;
        
        x = xprime;
        y = yprime;
        z = z - di * rot_ang;
    }
    
    xr = x;
    yr = y;
}

// What happens if we use quire for z and start at the latest iteration possible?
void posit_cordic_quirez_ff(posit32 z, int n, posit32& xr, posit32& yr) {
    if (n < 17) {
        printf("We require n >= 17.\n");
        exit(0);
    }
    
    posit32 di, y = 0.0;
    
    quire32 qz;
    qz.qma(z, 1.0);
    
    int i = -GetExponentValueForAngles0ToPiOver2(z.value);
	if (i > 0) i -= 1;
    posit32 x = (i >= 15) ? 1 : KVals[i];
    int c = i + n;
    if (c > 121) c = 121;
    
    for (; i < c; i++) {
        posit32 rot_ang = atan_table_p32[i];
        posit32 pow2 = scale_table_p32[i];

        if(qz.toPosit() >= 0) di = 1;
        else di = -1;
        
        posit32 xprime = x - y * di * pow2;
        posit32 yprime = y + x * di * pow2;
        qz.qms(rot_ang, pow2 * di);
        
        x = xprime;
        y = yprime;
    }
    
    xr = x;
    yr = y;
}

// This is the default posit algorithm for calculating atan.
posit32 posit_vector_default(posit32 x, posit32 y, int n) {
    posit32 di, z = 0.0;
    
    for (int i = 0; i < n; i++) {
        if (y >= 0) di = 1.0;
        else di = -1.0;
        
        posit32 pow2 = scale_table_p32[i];
        posit32 rot_ang = atan_table_p32[i] * pow2;

        posit32 x_prime = x + y * di * pow2;
        posit32 y_prime = y - x * di * pow2;
        
        x = x_prime;
        y = y_prime;
        z = z + di * rot_ang;
    }

    return z;
}

// What happens if we use quire for z?
posit32 posit_vector_quirez(posit32 x, posit32 y, int n) {
    posit32 di;
    quire32 qz;
    
    //iterate cordic algorithm
    for (int i = 0; i < n; i++) {
        posit32 rot_ang = atan_table_p32[i];
        posit32 pow2 = scale_table_p32[i];
        
        if(y >= 0) di = 1;
        else di = -1;
        
        posit32 xprime = x + y * di * pow2;
        posit32 yprime = y - x * di * pow2;
        
        x = xprime;
        y = yprime;
        qz.qma(rot_ang, pow2 * di);
    }
    
    return qz.toPosit();
}

// What happens if we start at the latest iteration possible?
posit32 posit_vector_ff(posit32 x, posit32 y, int n) {
    posit32 di, z = 0.0;
    
    int xExp = GetExponentValueForPosReals(x.value);
    int yExp = GetExponentValueForPosReals(y.value);
    int i = xExp - yExp;
    if (i < 0) i = 0;

    int c = i + n;
    if (c > 121) c = 121;
    
    for (; i < c; i++) {
        if (y >= 0) di = 1;
        else di = -1;
        posit32 pow2 = scale_table_p32[i];
        posit32 rot_ang = atan_table_p32[i] * pow2;

        posit32 xprime = x + y * di * pow2;
        posit32 yprime = y - x * di * pow2;
        
        x = xprime;
        y = yprime;
        z = z + di * rot_ang;
    }

    return z;
}

// What happens if we use quire for z and start at the latest iteration possible?
posit32 posit_vector_quirez_ff(posit32 x, posit32 y, int n) {
    posit32 di;
    quire32 qz;
    
    int xExp = GetExponentValueForPosReals(x.value);
    int yExp = GetExponentValueForPosReals(y.value);
    int i = xExp - yExp;
    if (i < 0) i = 0;
    
    int c = i + n;
    if (c > 121) c = 121;
    
    for (; i < c; i++) {
        posit32 rot_ang = atan_table_p32[i];
        posit32 pow2 = scale_table_p32[i];
        
        if(y >= 0) di = 1;
        else di = -1;
        
        posit32 xprime = x + y * di * pow2;
        posit32 yprime = y - x * di * pow2;
        
        x = xprime;
        y = yprime;
        qz.qma(rot_ang, pow2 * di);
    }
    
    return qz.toPosit();
}
